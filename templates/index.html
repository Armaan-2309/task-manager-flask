<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Neon Task Manager</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body class="dark-mode">
  <div class="container">
    <h1>Neon Task Manager</h1>

    <form action="/add" method="POST" onsubmit="return validateInput();">
      <input type="text" name="content" id="task-input" placeholder="Enter a task" maxlength="20" required>
      <button type="submit"><i class="fas fa-plus"></i></button>
    </form>

    <ul class="task-list">
      {% for task in tasks %}
        <li class="{% if task.completed %}completed{% endif %}">
          <span class="task-text">{{ task.content }}</span>
          <div class="icons">
            <a href="/done/{{ task.id }}" class="done-btn"><i class="fas fa-check"></i></a>
            <a href="/delete/{{ task.id }}" class="delete-btn"><i class="fas fa-trash"></i></a>
          </div>
        </li>
      {% endfor %}
    </ul>
  </div>

  <!-- Toggle dark/light mode -->
  <button id="mode-toggle" onclick="toggleMode()">
    <i class="fas fa-adjust"></i>
  </button>

  <!-- Sound effects -->
  <audio id="sound-add" src="{{ url_for('static', filename='sounds/add.mp3') }}"></audio>
  <audio id="sound-delete" src="{{ url_for('static', filename='sounds/delete.mp3') }}"></audio>
  <audio id="sound-done" src="{{ url_for('static', filename='sounds/done.mp3') }}"></audio>

  <script>
    // Sound effects
    document.querySelector('form').addEventListener('submit', function () {
      document.getElementById('sound-add').play();
    });

    document.querySelectorAll('.delete-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.getElementById('sound-delete').play();
      });
    });

    document.querySelectorAll('.done-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.getElementById('sound-done').play();
      });
    });

    // Toggle mode
    function toggleMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('mode', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
    }

    // Preserve theme on reload
    window.onload = () => {
      const saved = localStorage.getItem('mode');
      if (saved === 'light') document.body.classList.remove('dark-mode');
    };

    // Input validation
    function validateInput() {
      const input = document.getElementById('task-input').value.trim();
      if (input.length === 0 || input.length > 20) return false;
      return true;
    }
  </script>
</body>
</html>